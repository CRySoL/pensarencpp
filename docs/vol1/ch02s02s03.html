<?xml version="1.0" encoding="ISO-8859-1" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
    <title>2.2.3. Uso de librerías</title>
    <link rel="stylesheet" type="text/css" href="common.css" />
    <link rel="stylesheet" type="text/css" href="chunk.css" />
    <link rel="stylesheet" type="text/css" href="highlight.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.76.1" />
    <link rel="home" href="index.html" title="Pensar en C++ (Volumen 1)" />
    <link rel="up" href="ch02s02.html" title="2.2. Herramientas para compilación modular" />
    <link rel="prev" href="ch02s02s02.html" title="2.2.2. Enlazado" />
    <link rel="next" href="ch02s03.html" title="2.3. Su primer programa en C++" />
  </head>
  <body>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td class="navititle" width="1%">
            <a accesskey="p" href="ch02s02s02.html">
              <img src="./images/prev.png" alt="Anterior" />
            </a>
          </td>
          <td class="navititle" width="40%" align="left">
            <a accesskey="p" href="ch02s02s02.html">2.2.2. Enlazado</a>
          </td>
          <td width="10%" align="center">
            <a accesskey="u" href="ch02s02.html">
              <img src="./images/up.png" alt="Subir" />
            </a>
          </td>
          <td class="navititle" width="40%" align="right">
            <a accesskey="n" href="ch02s03.html">2.3. Su primer programa en C++</a>
          </td>
          <td class="navititle" width="1%" align="right">
            <a accesskey="n" href="ch02s03.html">
              <img src="./images/next.png" alt="Siguiente" />
            </a>
          </td>
        </tr>
      </table>
    </div>
    <div class="sect2" title="2.2.3. Uso de librerías">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title"><a id="idp4056424"></a>2.2.3. Uso de librerías</h3>
          </div>
        </div>
      </div>
      <p>
        Ahora que ya conoce la terminología básica, puede entender cómo
        utilizar una librería. Para usarla:
      </p>
      <div class="orderedlist">
        <ol class="orderedlist" type="1">
          <li class="listitem">
            <p>
            Se incluye el fichero de cabecera de la librería.
          </p>
          </li>
          <li class="listitem">
            <p>
            Se usan las funciones y las variables de la librería.
          </p>
          </li>
          <li class="listitem">
            <p>
            Se enlaza la librería junto con el programa ejecutable.
          </p>
          </li>
        </ol>
      </div>
      <p>
        Estos pasos también se aplican cuando los módulos objeto no se combinan
        para formar una librería. Incluir el fichero cabecera y enlazar los
        módulos objeto es la base para la compilación separada en C y en C++.
      </p>
      <div class="sect3" title="Cómo busca el enlazador una librería">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title"><a id="idp4060016"></a>Cómo busca el enlazador una librería</h4>
            </div>
          </div>
        </div>
        <p>
          Cuando se hace una refencia externa a una función o una
          variable en C o C++, al enlazador, una vez encontrada esta
          referencia, puede hacer dos cosas. Si todavía no ha encontrado
          la definición de la función o variable, añade el identificador
          a su lista de «referencias no resueltas». Si el
          enlazador ya había encontrado la definición, se resuelve la
          referencia.
        </p>
        <p>
          Si el enlazador no puede encontrar la definición en la lista
          de módulos objeto, busca en las librerías. Las librerías
          tienen algún tipo de indexación para que el enlazador no
          necesite buscar en todos los módulos objeto en la librería -
          solamente mira en el índice. Cuando el enlazador encuentra una
          definición en una librería, el módulo objeto entero, no sólo
          la definición de la función, se enlaza al programa
          ejecutable. Dese cuenta que no se enlaza la librería completa,
          tan solo el módulo objeto de la librería que contiene la
          definición que se necesita (de otra forma los programas se
          volverían innecesariamente largos). Si se desea minimizar el
          tamaño del programa ejecutable, se debería considerar poner
          una única función en cada fichero fuente cuando se construyan
          librerías propias. Esto requiere más trabajo de edición,
	  <sup>[<a id="idp4063840" href="#ftn.idp4063840" class="footnote">36</a>]</sup> pero puede ser muy útil para el usuario.
        </p>
        <p>
          Debido a que el enlazador busca los ficheros en el orden que
          se le dan, se puede prevenir el uso de una función de una
          librería insertando un fichero con su propia función, usando
          el mismo nombre de función, en la lista antes de que aparezca
          el nombre de la librería. Cuando el enlazador resuelva
          cualquier referencia a esa función encontrando la función
          antes de buscar en la librería, se utilizará su función en
          lugar de la que se encuentra en la librería. Eso también puede
          ser una fuente de errores, y es la clase de cosas que se puede
          evitar usando los espacios de nombres
          (<span class="foreignphrase"><em class="foreignphrase">namespaces</em></span>) de C++.
        </p>
      </div>
      <div class="sect3" title="Añadidos ocultos">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title"><a id="idp4066664"></a>Añadidos ocultos</h4>
            </div>
          </div>
        </div>
        <p>
          Cuando se crea un programa ejecutable en C/C++, ciertos
          elementos se enlazan en secreto. Uno de estos elementos es el
          módulo de arranque, que contiene rutinas de inicialización que
          deben ejecutarse cada vez que arranca un programa C o
          C++. Estas rutinas preparan la pila e inicializan ciertas
          variables del programa.
        </p>
        <p>
          El enlazador siempre busca la librería estándar para las versiones
          compiladas de cualquier función «estándar» llamada en el
          programa. Debido a que se busca siempre en la librería estándar, se
          puede usar cualquier cosa de esta librería simplemente añadiendo a su
          programa la cabecera apropiada; no necesita indicar dónde hay que
          buscar la librería estándar. Las funciones de flujo de entrada-salida
          (iostream), por ejemplo, están en la Librería Estándar de C++. Para
          usarla, sólo debe incluir el fichero de cabecera
          <code class="filename">&lt;iostream&gt;</code>.
        </p>
        <p>
          Si se está usando una librería, se debe añadir explícitamente
          su nombre de ésta a la lista de ficheros manejados por el
          enlazador.
        </p>
      </div>
      <div class="sect3" title="Uso de librerías C plano">
        <div class="titlepage">
          <div>
            <div>
              <h4 class="title"><a id="idp4070328"></a>Uso de librerías C plano</h4>
            </div>
          </div>
        </div>
        <p>
          Aunque esté escribiendo código en C++, nada le impide usar
          librerías de C. De hecho, toda la librería de C está incluida
          por defecto en el C++ Estándar. Hay una cantidad tremenda de
          trabajo ya realizado en esas librerías que le pueden ahorrar
          un montón de tiempo.
        </p>
        <p>
          Este libro usará la librería Estándar de C++ cuando sea
          necesario (y por lo tanto la de C), pero sólo se utilizarán
          funciones de la librería <span class="emphasis"><em>estándar</em></span>, para
          asegurar la portabilidad de los programas. En los pocos casos
          en los que las funciones no sean de C++ estándar, se intentará
          que sean funciones compatibles con POSIX. POSIX es un estándar
          basado en el esfuerzo por conseguir la estandarización de
          Unix, que incluye funciones que van más allá del ámbito de las
          librerías de C++. Normalmente puede esperar encontrar
          funciones POSIX en plataformas Unix (en particular,
          GNU/Linux), y a menudo en sistemas DOS/Windows. Por ejemplo,
          si está usando hilos (<span class="foreignphrase"><em class="foreignphrase">threads</em></span>)
          será mejor usar la librería de hilos compatible con POSIX ya
          que su código será más fácil de entender, portar y mantener (y
          la librería de hilos usará los servicios que ofrece el sistema
          operativo, si es que están soportados).
	</p>
      </div>
      <div class="footnotes">
        <br />
        <hr width="100" align="left" />
        <div class="footnote">
          <p><sup>[<a id="ftn.idp4063840" href="#idp4063840" class="para">36</a>] </sup>
	      Yo le recomendaría usar Perl o Python para automatizar
	      estas tareas como parte de su proceso de empaquetamiento de
	      librerías (ver <a class="ulink" href="http://www.perl.org" target="_top">www.Perl.org</a> ó <a class="ulink" href="http://www.python.org" target="_top">www.Python.org</a>).
	    </p>
        </div>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td class="navititle" width="1%">
            <a accesskey="p" href="ch02s02s02.html">
              <img src="./images/prev.png" alt="Anterior" />
            </a>
          </td>
          <td class="navititle" width="40%" align="left">
            <a accesskey="p" href="ch02s02s02.html">2.2.2. Enlazado</a>
          </td>
          <td width="10%" align="center">
            <a accesskey="u" href="ch02s02.html">
              <img src="./images/up.png" alt="Subir" />
            </a>
          </td>
          <td class="navititle" width="40%" align="right">
            <a accesskey="n" href="ch02s03.html">2.3. Su primer programa en C++</a>
          </td>
          <td class="navititle" width="1%" align="right">
            <a accesskey="n" href="ch02s03.html">
              <img src="./images/next.png" alt="Siguiente" />
            </a>
          </td>
        </tr>
        <tr>
          <td valign="top"> </td>
          <td> </td>
          <td width="10%" align="center">
            <a accesskey="h" href="index.html">
              <img src="./images/home.png" alt="Inicio" />
            </a>
          </td>
          <td> </td>
          <td valign="top"> </td>
        </tr>
      </table>
    </div>
  </body>
</html>
